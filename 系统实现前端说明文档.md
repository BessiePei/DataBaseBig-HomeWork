## 系统实现前端说明文档

## Build Setup

``` bash
# install dependencies
npm install

# serve with hot reload at localhost:8080
npm run dev

# build for production with minification
npm run build

# build for production and view the bundle analyzer report
npm run build --report
```

For a detailed explanation on how things work, check out the [guide](http://vuejs-templates.github.io/webpack/) and [docs for vue-loader](http://vuejs.github.io/vue-loader).

## 前端主要技术

Vue2.5.2 + element-ui + chakra-ui

使用vue框架进行开发

###  接口设计

主要通过axios与后端进行数据交互，

```
// 创建axios实例
const service = axios.create({
  baseURL: URL,
  timeout: 6000,  // 请求超时时间
  withCredentials: true,
})
```

主要方法为get/post/patch/delete，例如：

```
export function getBlogRemark(id) {
  return request({
    url: '/blog/' + id + '/remark/',
    method: 'get',
  })
}

export function updatePwd(data) {
  return request({
    url: '/changePassword/',
    method: 'patch',
    data
  })
}

export function submitFeedBack(data) {
  return request({
    url: '/feedback/',
    method: 'post',
    data
  })
}

export function deleteUserDish(id) {
  return request({
    url: '/users/1/dishes/' + id+ '/',
    method: 'delete'
  })
}
```

### 页面布局设计

### flex动态布局适应页面

全局使用flex布局，能够较好的适应不同的屏幕大小，从而在不同大小的屏幕中保持教为优秀的视觉效果。比如对于主界面：

```html
<div id="index">
    <myheader></myheader>
      <slider class="slider_pos"></slider>
      <user-show class="user-show_pos"></user-show>
      <merchantList class="merchantList_pos"></merchantList>
      <hotDishes class="dishList_pos"></hotDishes>
    <myfooter></myfooter>
  </div>
```

子组件内部属性参数由组件内部维护，组件相互独立（会在组件部分更详细的介绍）。父组件只需要空值子组件的排列位置即可。

```css
flex-shrink: 0; /*表示组件不会在排布过程中大小发生变化 */
order: 1; /* 空值组件排布的顺序和优先级 */
```

![index](E:\django\DBFrontEnd\document-img\image-20221224213924007.png)

### 组件的应用

Vue框架很重要的一个特点就是组件开发，这种开发方式为前端开发提供了极大的便利条件。

#### 外援库中的组件

在本次前端设计中引入了element-ui和chakra-ui组件库，使得前端开发可以在较短的时间达到较好看的效果。

![element-ui应用于部分表单](E:\django\DBFrontEnd\document-img\image-20221224210011845.png)

![chakra-ui应用](E:\django\DBFrontEnd\document-img\image-20221224210328792.png)

#### 自设计的组件

同时在本次开发中，也自行设计开发了一些组件，比如活动展示组件slider, 评论组件remark，收藏按钮组件faviorteButton等。通过组件复用节省了大量重复代码，节省了开发可设计时间。同时由于组件之间具有较高的独立性，在使用组件的时候可以避免组件之间的相互干扰。

```html
<slider :id="id" class="slider-pos"></slider>
<hot-dishes :id="id" class="hotdishes-pos"></hot-dishes>
```

通过给自行设计的组件传参数可以实现根据界面需求调节组件的功能和样式等，使得组件有更好的适应能力，同时保持了组件自身的风格，可以使得界面总体设计具有一致性，从而更具有美感。

### 分页/排序/筛选的实现

这部分由前端利用JavaScript实现，在一次性从后端获取所有可能需要展示的数据之后，通过相应用户操作，实时更新展示数据。

![searchPage](E:\django\DBFrontEnd\document-img\image-20221224211716592.png)

```js
// 获取分页显示数据
getShowData() {
      this.showData = this.ftmp.slice(
        (this.page - 1) * this.size,
        this.page * this.size
      );
      this.total = this.ftmp.length;
    },
// 实现排序
sortAPrice() {        
	this.ftmp.sort((a,b) => {
        return a.dishPrice - b.dishPrice;
      });
     this.page = 1;
     this.getShowData();
}
// 根据用户实现价过滤
 filterPrice() {
      this.ftmp = this.result.filter((item) => {
        return item.dishPrice >= this.lowborder && item.dishPrice <= this.highborder;
      })
      this.page=1;
      this.getShowData();
    }
```

### 数据图表显示

使用echarts实现图表显示；

在获取后端返回的数据，跟新图表的数据设置并显示，并且能够实现以图片形式的保存。

```js
getChart().then((response) => {
          console.log(response.data);
          myChart.setOption({
            series: [
              {
                type: 'pie',
                data: response.data,
                radius: ['40%', '70%']
              }
            ]
          });
        }).catch (function(error){
          console.log(error);
        })
```

![echart](E:\django\DBFrontEnd\document-img\image-20221224213028880.png)

### 安全性设计

#### localStorage存储登录用户信息

用户登录后，前端将后端关于登录用户信息的返回值存储到localStorage中，这样如果同一个用户没有退出，再次使用，就不需要再次登录，改善用户体验。

```
localStorage.setItem("userinfo", Response.data);
```

#### 对未登录用户的活动限制

主要有两种措施：

1. 隐藏开关：比如在主界面，未登录的用户无法看到，进入个人主页的按钮；
2. 对提交进行控制：比如在“逛逛”主页，未登录的用户如果尝试发帖将被提示"请先登录之后再发帖"。

![post-notlogin](E:\django\DBFrontEnd\document-img\image-20221224221055954.png)

#### 区分不同类型的用户

根据设计需求分析存在两类用户，一种是商家，可以开店、发布活动、发布菜品；另一种是普通用户不能够发布菜品、发布活动。

主要通过限制开关展示来控制：用户无法看到发布活动和发布菜品的开关。

![merchant-card](E:\django\DBFrontEnd\document-img\image-20221224223534485.png)

## 源程序设计

源程序结构

```
├─src									// 整个项目的主文件夹
│  │  App.vue							// 整个项目的入口文件
│  │  main.js							// 项目的主要JavaScript文件
│  │
│  ├─api								// 接口
│  │      activities.js
│  │      blogs.js
│  │      dishes.js
│  │      merchants.js
│  │      users.js
│  │
│  ├─assets								// 该项目放置的一些资源文件
│  │      logo.png
│  │
│  ├─components
│  │      HelloWorld.vue
│  │
│  ├─router								// 路径配置文件
│  │      index.js
│  │
│  ├─utils								// 请求配置文件
│  │      request.js
│  │
│  ├─views								// 主要组件
│  │  ├─activity
│  │  │      activityPage.vue			// 活动界面
│  │  │
│  │  ├─app
│  │  │      favoriteButton.vue			// 收藏按钮组件
│  │  │      footer.vue					// 页脚
│  │  │      header.vue					// 页头
│  │  │      remark.vue					// 评论组件
│  │  │
│  │  ├─dish							
│  │  │      dishPage.vue				// 菜品主页
│  │  │
│  │  ├─index
│  │  │      hotDishes.vue				// 热门菜品组件
│  │  │      index.vue					// 主页
│  │  │      merchantList.vue			// 商家列表
│  │  │      slider.vue					// 活动轮播组件
│  │  │      userShow.vue				// 用户信息组件
│  │  │
│  │  ├─merchant
│  │  │      merchantPage.vue			// 商家主页
│  │  │
│  │  ├─search
│  │  │      searchPage.vue				// 搜索主页
│  │  │
│  │  ├─user
│  │  │      openShopPage.vue			// 开店主页
│  │  │      personPage.vue				// 个人主页
│  │  │      reg.vue					// 登录/注册主页
│  │  │      userInfoCard.vue			// 个人信息卡
│  │  │      userTools.vue				// 用户工具组件
│  │  │
│  │  └─visit
│  │          blogPage.vue				// 博客主页
│  │          visitPage.vue				// 逛逛主页
│  │
│  └─vuex
│          store.js						// vuex 存储
│
└─static								// 静态信息
    │  .gitkeep
    │  
    ├─css
	|	   	...
    │
    ├─images
    │      	...
    │
    └─js
            ...

```



## 感想

本次数据库大作业，我主要负责前端的设计和开发工作。在前端设计阶段，需要充分调研市场需求和用户需求，不光要能够满足整体项目需求，同时要考虑用户的操作感受，还要考虑开发人员实现的难易程度等多方面信息，进行综合分析，并需要结合自己的创造力和审美绘制出初步的设计图纸，并且需要在设计开发过程中不断地进行完善。在本次前端开发过程中，由于之前对html和css有一定程度的掌握，所以在实际开发过程中，排版的难度感觉不是很大；本次实践中的一个突破是将自主设计的可调节组件应用到界面开发过程中，提高了开发效率和效果；尝试接触了echarts和一些常见组件库，提升了自己的开发能力。总体而言前端开发代码量大，但是难度不大，需要认真仔细和耐心。这次前端的作业也给了我宝贵的一次写此类程序的经验，也为以后的学习和工作打下了一定的基础，我想我一定会记得这次实验，记得一点一点的学习和进步，记得每一分努力和付出，带着这份收获不断前行。